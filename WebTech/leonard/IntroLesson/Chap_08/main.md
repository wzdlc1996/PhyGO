# 网络安全

## 概述

Internet技术飞速发展, 不断增加的新应用, 不断加入的网络, 人员的安全意识不足. 
网络系统日益复杂. 安全隐患急剧增加. Simple is powerful
黑客攻击威胁程度越来越高, 越来越容易实现. 

造成安全威胁的主要根源:
1.  网络建设之初忽略了安全问题
2.  仅仅建立了物理安全机制
3.  TCP/IP 协议族软件本身缺乏安全性
4.  操作系统本身及其配置的安全性不高
5.  安全产品配置的安全性不够.
1.  内部网用户的安全威胁
1.  缺乏有效手段监视
1.  网络应用程序的漏洞

网络安全发展的三个阶段
1.  通信保密阶段(40~70年代). 
    主要安全威胁时搭线窃听, 密码学分析
    主要保护措施是加密
    1.  1949年 Shannon 的《保密通信的信息理论》
    2.  1977年美国国家标准局公布的数据加密标准(DES)
    1.  1976年由Diffie和Hellman在 “New Directions in Cryptography” 一文中提出公钥密码体系
2.  计算机系统安全阶段(70~80年代)
    主要安全威胁扩展到非法访问, 恶意代码, 脆弱口令等
    主要保护措施是安全操作系统设计技术(TCB)
    1.  1983年美国国防部公布的可信计算机系统评估准则
3.  网络信息系统安全阶段(90年代以来): 重点保护信息
    主要安全威胁发展到网络入侵, 病毒破坏, 信息对抗的攻击等
    主要保护措施包括防火墙, 防病毒软件, 漏洞扫描, 入侵检测, PKI, VPN
    1.  提出了新的信息技术安全通用评估准则(CC: Common Criteria for Information Technology Security Evaluation, ISO-15408)

安全层次

从底层到上层:
安全的密码算法 - 安全协议 - 网络安全 - 系统安全 - 应用安全.

## 加密算法

是网络安全的根本. 
思想: 以某种只有合法的接收方才能解读的方式去搅乱报文(message)的数据码位, 其他任何人即使截取到了该加密报文也无法提取真实的信息. 

用途:
1.  保密性: 防止信息的非授权公布
1.  鉴别: 验证远程参与者身份
3.  完整性: 确保报文不被修改

代表性算法:
1.  数据加密标准(DES: data encryption standard)
1.  高级加密标准(AES)
1.  公开密钥算法(RSA)
1.  报文摘要方案MD5 (message digest 5)

### 数据加密标准DES

1971~1972年IMB研制. 1975年公开发表, 1977年标准化并生效

使用64位密钥(实际上是56位, 每个字节末尾为一个奇偶校验位)加密一个64位明文块

1.  把块中64bit完全打乱, 以不同次序排列(初始变换)
2.  对结果数据和密钥进行相同的操作循环16次
3.  将逆初始变换作用于结果.

DES 循环

1.  将64bit平分为左右两块 $L_{i-1}, R_{i-1}$
2.  从56bit密钥中选出不同的48个bit, 记为 $K_i$
3.  计算:
    $$
    L_i = R_{i-1} \ ; \ R_i = L_{i-1} \oplus f(R_{i-1},K_i)
    $$
    函数 $f$ 把 $R_{i-1}$ 分成8个4bit块, 每个块从相邻块中占用最右和最左bit扩充为6bit快, 这样 8x6和 $K_i$ 按位异或
    然后把结果通过某种算法S变换回32bit, 同 $L_{i-1}$ 异或.


DES 重复交替使用选择函数和置换运算两种变换, confusion + diffusion.

长报文情形, 末尾补0分块. 使用密码块连接(CBC)技术, i块密文同 i+1块明文异或后再使用DES.

没有见到DES是安全的数学证明, 其安全性通过混淆和扩散实现. 两个主要弱点: 密钥容量不够, S算法至今未公开技术细节. 破解速度逐年加快: 1999年1月的RSA数据安全会议期间, 22小时15分钟破解了一个DES密钥

### 高级加密标准 AES

1997年5月 NIST 征集AES方案以替代DES. 1999年8月, 找到5个最终候选方案, 2000年10月, 比利时的 Joan Daemen 和 Vincent Rijmen提出的 Rijndael最终胜出. 其密钥和明文块大小相互独立, 可以是128~256中任意32倍数bit, 标准化后要求固定. 

1.  密钥扩展
2.  根据key和block size 的取值进行10/12/14轮变换

每个阶段均可逆, 因此解密确实可以恢复明文. 

设计简单, 抗攻击能力强, 没有DES的弱密钥问题. 具有强扩展性: 加密轮数和循环移位偏移量作为参数可重新定义.

### RSA 算法

攻击方法
1.  穷举法: 尝试所有可能私钥. 素数分解极为困难(NP-hard)
2.  1990年6月20日, 美国数学家找到了155位10进制大数因子分解
3.  1994年破解了1977年提出时的密文, 当时提出时估计 4x 10^16年

### 报文摘要方案5 (md5)

把摘要值初始化为一个常量, 讲起依次同报文的512bit块计算, 直到生成最终摘要值. 

验证报文完整性.

软件实现上, DES和MD5要比RSA快几个数量级. 硬件实现上DES和MD5更快. 

因此RSA一般用来加密很少的数据, DES和MD5则工作在大数据集上. RSA鉴别身份, DES加密报文. MD5保护报文完整性.

## 安全机制

### 完整性机制

CRC等不足以保证数据完整性. 如攻击者同时修改校验值和报文以保持一致性.
除了报文摘要方案, 还可以使用报文鉴别码, 如密码散列(cryptographic hashing) 机制. 只有接收者才能正确验证校验码和报文.

数字签名:
签名时, 使用私钥对报文加密. 验证时使用公钥解密便可以验证报文发送方. 
对报文加密两次就可以同时保证报文的可验证性和保密性.

简单的三次握手方式:

1.  客户选择随机数 x , 使用自己密钥 chk 加密, 把 clientID, E(x, chk) 发送给服务器
2.  服务器使用它认为对应 clientID 的密钥 shk 来解密 x, 并返回 E(x+1, shk), E(y, shk)
3.  客户解密检查得到 (x+1), 此时客户鉴别了服务器, 返回给服务器 E(y+1, chk). 服务器解密得到 y+1. 此时服务器鉴别了客户. 即完成握手.

证书机制
