# IP 协议和传输层协议

## IP数据报和数据报转发

TCP/IP结构包含 application, transport, internet, network_interface.

IP协议的特点: 一种不可靠, 无连接的数据报传送服务协议
IP协议向传输层屏蔽了物理网络的差异

IP协议的主要功能:
1.  IP数据报的路由选择
2.  IP数据报传送
3.  差错处理

IP数据报(IP datagram) 是一个互联网分组. 和硬件帧有相同的基本格式. 一个head和数据区, 数据区大小可变. head中的源和目标地址均为IP地址. 

IP是为了操作各种类型的网络硬件设计. 但由于这些硬件工作情况差别很大, IP协议只保证尽力传递. 维护传递fidelity是更上层的网络软件保证的.

IPv4中, 由路由器负责分片, IPv6中由发送方主机负责分片

## UDP 协议

IP无法区分同一台计算机上的多个应用程序. 数据报头没有额外码位标记应用程序. 

能够允许将单个应用程序座位通信断电(endpoint) 的协议被称为 **端到端协议** 或 **传输协议**. TCP/IP的设计使用传输层来实现端到端协议.

用户数据报协议(UDP):
1.  端到端. 提供协议 **端口**, 是的应用进程能够向其他进程发送数据报, 进行进程间通信. INAN维护了一个端口清单. 
2.  UDP数据报无连接, 不可靠. 不提供确认, 消息反馈控制. 可靠性需要应用程序提供
3.  面向报文. 使用UDP的应用进程所发送和接收的数据是单个报文.
4.  尽力而为. 提供给应用的和IP一样, 尽力传递机制
5.  任意交互. 允许进程之间发送接收多对多
6.  操作系统无关性. 

## TCP 协议

TCP 传输控制协议:
1.  面向连接. 面向连接的服务, 应用进程必须申请一个到目的地的连接
2.  端到端通信
3.  全双工通道. 发送接收同时进行
4.  完全可靠性. TCP保证通过一个连接发送的数据确定送到. 不会丢失乱序
5.  流接口: 可以发送连续字节流
6.  可靠的连接建立: 不同的连接互相独立
7.  有好的连接关闭: 保证关闭连接前传递的所有数据的可靠性.

TCP三次握手: 发送方提出同步请求, 接收方回应同步请求+同步请求, 发送方回应同步请求. 然后连接建立开始数据传输.